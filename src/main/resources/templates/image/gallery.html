<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/web/thymeleaf/layout"
	xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity3" layout:decorator="_layout">
	<head>
		<title th:text="#{image.gallery.title}"></title>
		<link rel="stylesheet" th:href="@{/blueimpgallery/css/blueimp-gallery.min.css}" />
	</head>
	<body>
		<div layout:fragment="content" class="container">
			<div class="alert" th:classappend="${globalMessage.cssClass}" th:if="${globalMessage}" th:text="${globalMessage.text}"></div>
			<div class="row">
				<div class="col-xs-12 col-sm-6 col-md-4">
					<div id="links" class="gallery-images">
						<div th:id="${galleryGroup}" th:each="galleryGroup : ${groupedImageCommands.keySet()}">
							<label th:text="${galleryGroup}"></label>
							<br/>
							<a th:each="imageCommand : ${groupedImageCommands.get(galleryGroup)}" th:href="@{'/gallery/show/' + ${imageCommand.imageId}}" 
										th:title="${imageCommand.description}" th:attr="data-gallery='#blueimp-gallery-'+${imageCommand.galleryGroup}">
						        <img th:src="@{'data:image/jpeg;base64,'+${imageCommand.thumbImageAsBase64}}" th:alt="${imageCommand.imageId}" class="img-responsive"/>
						    </a>
						</div>												
					</div>
					
					<div id="blueimp-gallery" class="blueimp-gallery blueimp-gallery-controls">
					    <div class="slides"></div>
					    <h3 class="title"></h3>
					    <a class="prev">‹</a>
					    <a class="next">›</a>
					    <a class="close">×</a>
					    <a class="play-pause"></a>
					    <ol class="indicator"></ol>
					</div>					
					<script type="text/javascript" th:src="@{/blueimpgallery/js/blueimp-gallery.min.js}"></script>
					<script>
					document.getElementById('links').onclick = function (event) {
					    event = event || window.event;
					    var target = event.target || event.srcElement,
					        link = target.src ? target.parentNode : target,
					        options = {index: link, event: event, fullScreen: true},
					        links = this.getElementsByTagName('a');
					    blueimp.Gallery(links, options);
					};
					</script>
				</div>
			</div>
			<br/>
			<div class="row">
				<div class="col-xs-12 col-sm-6 col-md-4">
					<a href="#" th:href="@{/image/show}" th:text="#{image.gallery.toUploadImagePage}"></a>
				</div>	
			</div>
			<br/>
			<div class="row" th:if="${!groupedImageCommands.isEmpty()}">
				<div class="col-xs-12 col-sm-6 col-md-4">
					<a href="#" th:href="@{/gallery/download/all}" th:text="#{image.gallery.downloadAll}"></a>
				</div>	
			</div>
		</div>
	</body>	
</html>